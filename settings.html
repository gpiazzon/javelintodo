<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Settings - Javelin Checklist</title>
  <link
    href="https://cdn.jsdelivr.net/npm/tailwindcss@^3/dist/tailwind.min.css"
    rel="stylesheet"
  />
  <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/lucide.min.js"></script>
</head>
  <body class="bg-gray-100 text-gray-900">
    <header class="sticky top-0 z-10 bg-white flex items-center justify-between shadow p-4">
      <a href="index.html" class="text-xl" aria-label="Back">⬅️</a>
      <h1 class="font-bold text-lg text-center flex-1">Settings</h1>
    </header>

    <main class="p-4 space-y-4">
      <div class="space-y-2">
        <label for="day-select" class="block font-medium">Choose Day:</label>
        <select id="day-select" class="border rounded p-2">
          <option value="monday">Monday</option>
          <option value="tuesday">Tuesday</option>
          <option value="wednesday">Wednesday</option>
          <option value="thursday">Thursday</option>
          <option value="friday">Friday</option>
          <option value="saturday">Saturday</option>
          <option value="sunday">Sunday</option>
        </select>
        <label for="accent-input" class="block mt-2 font-medium">Accent color:</label>
        <input type="color" id="accent-input" class="border rounded p-1" />
      </div>

      <div class="space-y-2">
        <textarea id="tasks-input" rows="15" class="w-full border rounded p-2" ></textarea>
        <button id="save-btn" class="px-3 py-1 rounded bg-blue-500 text-white hover:bg-blue-600 transition-colors">Save Tasks</button>
        <p class="text-sm">Edit tasks as JSON. Changes apply from today forward.</p>
      </div>

      <h2 class="font-semibold mt-6">Appearance</h2>
      <div class="space-y-2">
        <label for="emoji-input" class="block font-medium">Task emoji:</label>
        <input id="emoji-input" maxlength="2" class="border rounded p-1 w-12" />
        <div class="mt-2">
          <label class="inline-flex items-center gap-2"><input type="checkbox" id="quote-toggle" class="border rounded"/> <span>Show motivational quote</span></label>
        </div>
        <label class="block mt-2 font-medium">Confetti colors:</label>
        <div class="flex gap-2">
          <input type="color" id="confetti1" class="border rounded p-1" />
          <input type="color" id="confetti2" class="border rounded p-1" />
        </div>
        <button id="save-settings-btn" class="mt-2 px-3 py-1 rounded bg-blue-500 text-white hover:bg-blue-600 transition-colors">Save Settings</button>
      </div>
    </main>

    <script src="settings.js"></script>
    <script src="tasks.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const select = document.getElementById('day-select');
      const input = document.getElementById('tasks-input');
      const accent = document.getElementById('accent-input');
      const emojiInput = document.getElementById('emoji-input');
      const quoteToggle = document.getElementById('quote-toggle');
      const conf1 = document.getElementById('confetti1');
      const conf2 = document.getElementById('confetti2');

      const settings = loadSettings();

      function loadCurrent() {
        const day = select.value;
        const tasks = getTasksFor(day, new Date());
        input.value = JSON.stringify(tasks, null, 2);
        accent.value = settings.colors[day] || '#ffffff';
      }

      select.onchange = loadCurrent;
      loadCurrent();
      emojiInput.value = settings.emoji;
      quoteToggle.checked = settings.showQuotes;
      conf1.value = settings.confettiColors[0] || '#bb0000';
      conf2.value = settings.confettiColors[1] || '#ffffff';

      document.getElementById('save-btn').onclick = () => {
        try {
          const obj = JSON.parse(input.value);
          saveNewTasks(select.value, obj);
          alert('Saved!');
        } catch(e) {
          alert('Invalid JSON');
        }
      };

      document.getElementById('save-settings-btn').onclick = () => {
        settings.colors[select.value] = accent.value;
        settings.emoji = emojiInput.value;
        settings.showQuotes = quoteToggle.checked;
        settings.confettiColors = [conf1.value, conf2.value];
        saveSettings(settings);
        alert('Settings saved!');
      };

      lucide.replace();
    });
  </script>
</body>
</html>
